<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chrono.io</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #fff;
            font-family: monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* === CONTROL BUTTONS === */
        .top-right-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: row-reverse;
            gap: 10px;
        }

        .btn {
            background: #333;
            color: #fff;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-family: monospace;
            transition: background 0.2s;
        }

        .btn:hover {
            background: #555;
        }

        #mode {
            display: none;
        }

        #numbers {
            display: none;
        }

        #hideBtn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 8px 12px;
            font-size: 16px;
        }

        /* === DIGITAL CLOCK === */
        #digital {
            font-size: 80px;
            letter-spacing: 5px;
        }

        /* === ANALOG CLOCK === */
        #analog {
            display: none;
        }

        .clock-face {
            width: 400px;
            height: 400px;
            border: 4px solid #fff;
            border-radius: 50%;
            position: relative;
        }

        /* Clock markers (60 total: 12 hour + 48 minute markers) */
        .marker {
            position: absolute;
            background: #fff;
            left: 50%;
            top: 0;
            transform-origin: center 200px;
        }

        .hour-marker {
            width: 4px;
            height: 20px;
            margin-left: -2px;
        }

        .minute-marker {
            width: 2px;
            height: 10px;
            margin-left: -1px;
        }

        /* Clock hands */
        .hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            transform-origin: bottom center;
            background: #fff;
            transform: translateX(-50%) rotate(var(--rotation-angle, 0deg));
        }

        .hour {
            width: 6px;
            height: 120px;
        }

        .minute {
            width: 4px;
            height: 160px;
        }

        .second {
            width: 2px;
            height: 180px;
            background: #f00;
        }

        .center {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 12px;
            height: 12px;
            background: #fff;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        /* Clock numbers (1-12) */
        .number {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 40px;
            height: 40px;
            display: none;
            align-items: center;
            justify-content: center;
            margin-left: -20px;
            margin-top: -20px;
            font-size: 24px;
            font-weight: bold;
        }

        .number.show {
            display: flex;
        }
    </style>
</head>
<body>
    <div class="top-right-buttons">
        <button id="toggle" class="btn">ANALOG</button>
        <button id="format" class="btn">12H</button>
        <button id="mode" class="btn">GLIDE</button>
        <button id="numbers" class="btn">NUMBERS</button>
    </div>
    <button id="hideBtn" class="btn">HIDE</button>
    
    <div id="digital">00:00:00</div>
    
    <div id="analog">
        <div class="clock-face">
            <div id="markers"></div>
            <div id="clockNumbers"></div>
            <div class="hand hour" id="hour"></div>
            <div class="hand minute" id="minute"></div>
            <div class="hand second" id="second"></div>
            <div class="center"></div>
        </div>
    </div>

    <script>
        // ============================================
        // CONSTANTS
        // ============================================
        const DOM = {
            digital: document.getElementById('digital'),
            analog: document.getElementById('analog'),
            toggle: document.getElementById('toggle'),
            format: document.getElementById('format'),
            mode: document.getElementById('mode'),
            numbers: document.getElementById('numbers'),
            hide: document.getElementById('hideBtn'),
            hands: {
                hour: document.getElementById('hour'),
                minute: document.getElementById('minute'),
                second: document.getElementById('second')
            },
            markers: document.getElementById('markers'),
            clockNumbers: document.getElementById('clockNumbers'),
            topRightButtons: document.querySelector('.top-right-buttons')
        };

        const STATE = {
            isDigital: true,
            isGliding: false,
            showNumbers: false,
            is24Hour: true,
            buttonsHidden: false,
            animationFrame: null,
            tickInterval: null
        };

        // ============================================
        // CORE LOGIC
        // ============================================

        /**
         * Updates the clock display (both analog and digital).
         * This function is called on every animation frame (in glide mode) or every second (in tick mode).
         */
        function updateClock() {
            const now = new Date();
            const time = {
                hours: now.getHours(),
                minutes: now.getMinutes(),
                seconds: now.getSeconds(),
                milliseconds: STATE.isGliding ? now.getMilliseconds() : 0
            };

            updateDigitalClock(time);
            updateAnalogClock(time);
        }

        /**
         * Updates the digital clock face with the current time.
         */
        function updateDigitalClock({ hours, minutes, seconds }) {
            const pad = n => n.toString().padStart(2, '0');
            let displayHours = hours;
            let suffix = '';

            if (!STATE.is24Hour) {
                suffix = hours >= 12 ? ' PM' : ' AM';
                displayHours = hours % 12 || 12; // Use 12 for 0 (midnight)
            }

            DOM.digital.textContent = `${pad(displayHours)}:${pad(minutes)}:${pad(seconds)}${suffix}`;
        }

        /**
         * Updates the analog clock hands based on the current time.
         * In "glide" mode, it uses milliseconds for smooth, continuous movement.
         */
        function updateAnalogClock({ hours, minutes, seconds, milliseconds }) {
            // Calculate fractional values for smooth hand movement.
            // - Total seconds: current seconds + (milliseconds / 1000)
            // - Total minutes: current minutes + (total seconds / 60)
            // - Total hours:   (current hour % 12) + (total minutes / 60)
            const secondsWithMs = seconds + milliseconds / 1000;
            const minutesWithSeconds = minutes + secondsWithMs / 60;
            const hoursWithMinutes = (hours % 12) + minutesWithSeconds / 60;

            // Rotation degrees for each hand (e.g., 360° / 60s = 6° per second).
            const angles = {
                second: secondsWithMs * 6,
                minute: minutesWithSeconds * 6,
                hour: hoursWithMinutes * 30
            };

            DOM.hands.second.style.setProperty('--rotation-angle', `${angles.second}deg`);
            DOM.hands.minute.style.setProperty('--rotation-angle', `${angles.minute}deg`);
            DOM.hands.hour.style.setProperty('--rotation-angle', `${angles.hour}deg`);
        }

        /**
         * A recursive animation loop for smooth clock hand movement.
         * It stops when the state's `isGliding` flag is false.
         */
        function animate() {
            updateClock();
            if (STATE.isGliding) {
                STATE.animationFrame = requestAnimationFrame(animate);
            }
        }

        // ============================================
        // UI & DISPLAY LOGIC
        // ============================================

        /**
         * Central function to update the entire UI based on the current application state.
         */
        function updateUI() {
            // Toggle between Digital and Analog clock displays
            DOM.digital.style.display = STATE.isDigital ? 'block' : 'none';
            DOM.analog.style.display = STATE.isDigital ? 'none' : 'block';

            // Update button text content
            DOM.toggle.textContent = STATE.isDigital ? 'ANALOG' : 'DIGITAL';
            DOM.format.textContent = STATE.is24Hour ? '12H' : '24H';
            DOM.mode.textContent = STATE.isGliding ? 'TICK' : 'GLIDE';
            DOM.numbers.textContent = STATE.showNumbers ? 'MARKERS' : 'NUMBERS';

            // --- Button Visibility ---
            DOM.topRightButtons.style.display = STATE.buttonsHidden ? 'none' : 'flex';

            if (!STATE.buttonsHidden) {
                DOM.format.style.display = STATE.isDigital ? 'block' : 'none';
                DOM.mode.style.display = STATE.isDigital ? 'none' : 'block';
                DOM.numbers.style.display = STATE.isDigital ? 'none' : 'block';
            }

            // Toggle number visibility on the analog clock face
            document.querySelectorAll('.number').forEach(n => {
                n.classList.toggle('show', STATE.showNumbers)
            });
        }

        // ============================================
        // EVENT HANDLERS & TOGGLES
        // ============================================

        function toggleClockMode() {
            STATE.isDigital = !STATE.isDigital;
            updateUI();
        }

        function toggleTimeFormat() {
            STATE.is24Hour = !STATE.is24Hour;
            updateUI();
            updateClock(); // Instantly reflect time format change
        }

        function toggleGlideMode() {
            STATE.isGliding = !STATE.isGliding;
            if (STATE.isGliding) {
                // If switching to glide, clear the one-second interval and start smooth animation.
                clearInterval(STATE.tickInterval);
                STATE.tickInterval = null;
                animate();
            } else {
                // If switching to tick, stop the animation and restart the one-second interval.
                cancelAnimationFrame(STATE.animationFrame);
                STATE.animationFrame = null;
                if (!STATE.tickInterval) {
                    STATE.tickInterval = setInterval(updateClock, 1000);
                }
            }
            updateUI();
        }

        function toggleNumbers() {
            STATE.showNumbers = !STATE.showNumbers;
            updateUI();
        }

        function toggleButtonVisibility() {
            STATE.buttonsHidden = !STATE.buttonsHidden;
            updateUI();
        }

        // ============================================
        // INITIALIZATION
        // ============================================

        /**
         * Attaches event listeners to all control buttons.
         */
        function attachEventListeners() {
            DOM.toggle.addEventListener('click', toggleClockMode);
            DOM.format.addEventListener('click', toggleTimeFormat);
            DOM.mode.addEventListener('click', toggleGlideMode);
            DOM.numbers.addEventListener('click', toggleNumbers);
            DOM.hide.addEventListener('click', toggleButtonVisibility);
        }

        /**
         * Generates the 60 markers (48 minute, 12 hour) for the analog clock face.
         */
        function generateMarkers() {
            const fragment = document.createDocumentFragment();
            for (let i = 0; i < 60; i++) {
                const marker = document.createElement('div');
                const isHourMarker = i % 5 === 0;
                marker.className = `marker ${isHourMarker ? 'hour-marker' : 'minute-marker'}`;
                marker.style.transform = `rotate(${i * 6}deg)`;
                fragment.appendChild(marker);
            }
            DOM.markers.appendChild(fragment);
        }

        /**
         * Generates and positions the 12 numbers on the analog clock face using polar coordinates.
         */
        function generateNumbers() {
            const RADIUS = 150; // Distance of numbers from the center
            const fragment = document.createDocumentFragment();
            for (let i = 1; i <= 12; i++) {
                const num = document.createElement('div');
                num.className = 'number';

                // Convert hour to angle (in radians) for positioning.
                // (i * 30) gives the angle in degrees; -90 offsets it to start from the top (12 o'clock).
                const angle = (i * 30 - 90) * (Math.PI / 180);
                const x = Math.cos(angle) * RADIUS;
                const y = Math.sin(angle) * RADIUS;

                num.style.transform = `translate(${x}px, ${y}px)`;
                num.textContent = i;
                fragment.appendChild(num);
            }
            DOM.clockNumbers.appendChild(fragment);
        }

        /**
         * Initializes the clock application.
         */
        function init() {
            generateMarkers();
            generateNumbers();
            attachEventListeners();
            updateUI();
            updateClock();

            // Start the clock in "tick" mode (updates every second).
            if (!STATE.tickInterval) {
                STATE.tickInterval = setInterval(updateClock, 1000);
            }
        }

        // Start the application
        init();
    </script>
</body>
</html>